<!--pages/index/index.wxml-->
<view class="container">
  <!-- åˆ†ç±»å¯¼èˆª -->
  <view class="category-nav">
    <scroll-view scroll-x class="category-scroll">
      <view 
        wx:for="{{categories}}" 
        wx:key="id" 
        class="category-item {{currentCategory === item.id ? 'active' : ''}}"
        data-id="{{item.id}}"
        bindtap="handleCategoryChange"
      >
        {{item.name}}
      </view>
    </scroll-view>
  </view>

  <!-- èœå“åˆ—è¡¨ -->
  <view class="dish-list">
    <view wx:if="{{loading}}" class="loading">
      <text>åŠ è½½ä¸­...</text>
    </view>
    
    <view wx:elif="{{dishes.length === 0}}" class="empty-state">
      <text>æš‚æ— èœå“</text>
    </view>
    
    <view wx:else class="dish-grid">
      <view 
        wx:for="{{dishes}}" 
        wx:key="id" 
        class="dish-card"
      >
        <view class="dish-image">
          <image 
            wx:if="{{item.image_url}}"
            src="{{item.image_url}}" 
            mode="aspectFill"
            class="dish-real-image"
          ></image>
          <view wx:else class="dish-placeholder-text">æš‚æ— å›¾ç‰‡</view>
        </view>
        
        <view class="dish-info">
          <view class="dish-name">{{item.name}}</view>
          <view class="dish-desc">{{item.description || 'æš‚æ— æè¿°'}}</view>
          <view class="dish-footer">
            <view class="dish-price">
              <text class="price-symbol">Â¥</text>
              <text class="price-value">{{item.price}}</text>
            </view>
            
            <view class="dish-actions">
              <view 
                wx:if="{{cart[item.id]}}" 
                class="quantity-control"
              >
                <view 
                  class="btn-minus" 
                  data-id="{{item.id}}"
                  bindtap="handleRemoveFromCart"
                >
                  -
                </view>
                <text class="quantity">{{cart[item.id].quantity}}</text>
                <view 
                  class="btn-plus" 
                  data-dish="{{item}}"
                  bindtap="handleAddToCart"
                >
                  +
                </view>
              </view>
              
              <view 
                wx:else
                class="btn-add" 
                data-dish="{{item}}"
                bindtap="handleAddToCart"
              >
                +
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- è´­ç‰©è½¦åº•æ  -->
  <view class="cart-bar" wx:if="{{totalCount > 0}}">
    <view class="cart-info" bindtap="handleViewCart">
      <view class="cart-icon">
        <text class="icon">ğŸ›’</text>
        <view class="cart-badge">{{totalCount}}</view>
      </view>
      <view class="cart-price">
        <text class="label">æ€»è®¡ï¼š</text>
        <text class="price">Â¥{{totalPrice}}</text>
      </view>
    </view>
    
    <view class="cart-actions">
      <view class="btn-clear" bindtap="handleClearCart">æ¸…ç©º</view>
      <view class="btn-checkout" bindtap="handleViewCart">å»ç»“ç®—</view>
    </view>
  </view>
</view>
