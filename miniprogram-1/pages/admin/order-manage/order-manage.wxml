<!--pages/admin/order-manage/order-manage.wxml-->
<view class="container">
  <view class="page-header">
    <text class="page-title">订单管理</text>
  </view>

  <!-- 状态筛选 -->
  <scroll-view class="status-tabs" scroll-x>
    <view 
      wx:for="{{statusList}}" 
      wx:key="value"
      class="status-tab {{currentStatus === item.value ? 'active' : ''}}"
      data-status="{{item.value}}"
      bindtap="handleStatusChange"
    >
      {{item.label}}
    </view>
  </scroll-view>

  <!-- 订单列表 -->
  <view wx:if="{{loading}}" class="loading">加载中...</view>
  
  <view wx:elif="{{orders.length === 0}}" class="empty">
    <text class="empty-text">暂无订单</text>
  </view>

  <view wx:else class="order-list">
    <view wx:for="{{orders}}" wx:key="id" class="order-item">
      <!-- 订单头部 -->
      <view class="order-header">
        <text class="order-no">订单号：{{item.order_no}}</text>
        <text class="order-status status-{{item.status}}">
          {{item.status === 1 ? '待支付' : item.status === 2 ? '已支付' : item.status === 3 ? '配送中' : item.status === 4 ? '已完成' : '已取消'}}
        </text>
      </view>

      <!-- 订单信息 -->
      <view class="order-body">
        <view class="order-info">
          <text class="info-item">用户：{{item.user_nickname || '未知'}}</text>
          <text class="info-item">金额：¥{{item.total_price}}</text>
          <text class="info-item">时间：{{item.created_at}}</text>
        </view>
        
        <!-- 订单商品 -->
        <view class="order-items">
          <view wx:for="{{item.items}}" wx:key="id" wx:for-item="dish" class="dish-row">
            <text class="dish-name">{{dish.dish_name}}</text>
            <text class="dish-info">x{{dish.quantity}} ¥{{dish.subtotal}}</text>
          </view>
        </view>
      </view>

      <!-- 订单操作 -->
      <view class="order-footer">
        <button 
          class="btn-detail" 
          data-id="{{item.id}}"
          bindtap="handleViewDetail"
        >
          查看详情
        </button>
        <button 
          wx:if="{{item.status < 4 && item.status !== 5}}"
          class="btn-process" 
          data-order="{{item}}"
          bindtap="handleProcessOrder"
        >
          处理订单
        </button>
      </view>
    </view>
  </view>
</view>

